# Frostbyte ETL Pipeline - Environment Configuration
# Generated: 2026-02-10
# Mode: Development (local Docker)
# 
# INSTRUCTIONS:
# 1. Copy this file to .env: cp .env.example .env
# 2. Replace placeholder values with actual API keys
# 3. Never commit .env to version control

# =============================================================================
# REQUIRED API KEYS (User must obtain these)
# =============================================================================

# OpenRouter API Key for online embeddings
# Get from: https://openrouter.ai/keys
OPENROUTER_API_KEY=your_openrouter_key_here

# Hetzner Cloud API Token for infrastructure provisioning
# Get from: https://console.hetzner.cloud/projects → Security → API Tokens
HETZNER_TOKEN=your_hetzner_token_here

# =============================================================================
# DATABASE CONNECTIONS (Docker defaults)
# =============================================================================

# PostgreSQL - Primary database for metadata, lineage, audit
# Default: local Docker container
DATABASE_URL=postgresql://frostbyte:frostbyte_dev@localhost:5432/frostbyte_dev

# PostgreSQL for Qdrant (if using separate DB)
QDRANT_DATABASE_URL=postgresql://frostbyte:frostbyte_dev@localhost:5432/qdrant_dev

# Redis - Task queue broker, caching, rate limiting
# Default: local Docker container
REDIS_URL=redis://localhost:6379/0

# =============================================================================
# SERVICE ENDPOINTS (Docker defaults)
# =============================================================================

# MinIO (S3-compatible object storage)
MINIO_ENDPOINT=localhost:9000
MINIO_ACCESS_KEY=frostbyte
MINIO_SECRET_KEY=frostbyte_secret_key
MINIO_BUCKET=documents
MINIO_SECURE=false

# Qdrant (Vector store)
QDRANT_HOST=localhost
QDRANT_PORT=6333
QDRANT_API_KEY=

# =============================================================================
# EMBEDDING CONFIGURATION
# =============================================================================

# Online mode: OpenRouter configuration
OPENROUTER_BASE_URL=https://openrouter.ai/api/v1
OPENROUTER_MODEL=openai/text-embedding-3-small
OPENROUTER_DIMENSIONS=768

# Offline mode: Nomic local configuration
NOMIC_MODEL_PATH=/models/nomic-embed-text-v1.5
NOMIC_DIMENSIONS=768

# Mode selection: online | offline
EMBEDDING_MODE=online

# Foundation layer (FOUNDATION_LAYER_PLAN)
FROSTBYTE_MODE=offline
FROSTBYTE_CONTROL_DB_URL=postgresql://frostbyte:frostbyte@localhost:5432/frostbyte
FROSTBYTE_MINIO_ENDPOINT=http://localhost:9000
FROSTBYTE_SOPS_KEYS_PATH=.secrets/tenants

# =============================================================================
# SECURITY & ENCRYPTION
# =============================================================================

# SOPS + age secrets management
SOPS_AGE_KEY_FILE=.secrets/age.key
SECRETS_DIR=.secrets/tenants

# Document encryption at rest
ENCRYPTION_KEY_PATH=.secrets/encryption.key

# JWT configuration
JWT_SECRET=change_me_in_production_jwt_secret_32_characters
JWT_ALGORITHM=HS256
JWT_EXPIRATION_HOURS=24

# Local dev: bypass JWT auth when FROSTBYTE_AUTH_BYPASS=1 (no Bearer required)
FROSTBYTE_AUTH_BYPASS=0

# Redis (rate limit, parse queue); inherits REDIS_URL if not set
FROSTBYTE_REDIS_URL=redis://localhost:6379/0

# ClamAV (malware scan); falls back to clean when unavailable
CLAMAV_HOST=localhost
CLAMAV_PORT=3310
# CLAMAV_SOCKET=/var/run/clamav/clamd.sock

# =============================================================================
# SSO/SAML CONFIGURATION (Phase 2)
# =============================================================================

SSO_CERT_PATH=/path/to/sso/certificate.pem
SAML_ENTITY_ID=frostbyte-etl
SAML_ACS_URL=http://localhost:8000/auth/saml/acs
SAML_IDP_METADATA_URL=

OIDC_ISSUER_URL=
OIDC_CLIENT_ID=
OIDC_CLIENT_SECRET=
OIDC_REDIRECT_URI=http://localhost:8000/auth/oidc/callback

# =============================================================================
# PIPELINE CONFIGURATION
# =============================================================================

# Document processing
MAX_FILE_SIZE_MB=100
ALLOWED_EXTENSIONS=pdf,docx,txt,md,html,json,csv,xlsx,pptx
CHUNK_SIZE=512
CHUNK_OVERLAP=50

# Batch processing
MAX_BATCH_SIZE=10000
BATCH_TIMEOUT_SECONDS=300
PROGRESS_UPDATE_INTERVAL_MS=1000

# Policy gates
PII_DETECTION_ENABLED=true
INJECTION_DETECTION_ENABLED=true
MALWARE_SCAN_ENABLED=true

# =============================================================================
# MONITORING & OBSERVABILITY
# =============================================================================

# Prometheus
PROMETHEUS_PORT=9090
METRICS_ENABLED=true

# Grafana
GRAFANA_PORT=3000
GRAFANA_ADMIN_USER=admin
GRAFANA_ADMIN_PASSWORD=admin

# Structured logging
LOG_LEVEL=INFO
LOG_FORMAT=json

# =============================================================================
# TENANT ISOLATION (Hetzner Configuration)
# =============================================================================

# Default Hetzner region
HETZNER_REGION=nbg1
HETZNER_SERVER_TYPE=cx21
HETZNER_VOLUME_SIZE_GB=100

# Network configuration
TENANT_NETWORK_ZONE=eu-central
TENANT_FIREWALL_RULES=strict

# =============================================================================
# EXPORT BUNDLE CONFIGURATION
# =============================================================================

# Ed25519 signing keys
SIGNING_KEY_PATH=.secrets/signing.key
VERIFYING_KEY_PATH=.secrets/signing.pub

# Bundle format
BUNDLE_FORMAT=tar.gz
BUNDLE_CHECKSUM_ALGORITHM=sha256

# =============================================================================
# DEVELOPMENT CONFIGURATION
# =============================================================================

# Application
FROSTBYTE_REPO_ROOT=/Users/coreyalejandro/Projects/frostbyte_etl_colabbooks_pack_2026-02-07
FROSTBYTE_ENV=dev
APP_PORT=8000
APP_HOST=0.0.0.0
DEBUG=true

# Testing
TEST_DATABASE_URL=postgresql://frostbyte:frostbyte_dev@localhost:5432/frostbyte_test
PYTEST_WORKERS=4
COVERAGE_THRESHOLD=85

# Hot reload
RELOAD_ON_CHANGE=true
